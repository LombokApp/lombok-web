{
  "description": "An app implementing core functionality.",
  "identifier": "core",
  "label": "Core",
  "requiresStorage": false,
  "subscribedPlatformEvents": [
    "platform:object_added",
    "platform:object_removed",
    "platform:object_updated",
    "platform:worker_task_enqueued"
  ],
  "tasks": [
    {
      "identifier": "analyze_object",
      "label": "Analyze Object",
      "description": "Analyze the content of a file and save the result as metadata",
      "triggers": [
        {
          "kind": "event",
          "eventIdentifier": "platform:object_added",
          "dataTemplate": {
            "folderId": "{{event.data.folderId}}",
            "objectKey": "{{event.data.objectKey}}"
          },
          "onComplete": {
            "taskIdentifier": "analyze_object",
            "dataTemplate": {
              "success": {
                "someKey": "{{task.result.someKey}}"
              }
            }
          }

        }
      ],
      "handler": {
        "type": "external"
      }
    },
    {
      "identifier": "run_worker_script",
      "label": "Run Worker",
      "description": "Run a worker script.",
      "triggers": [
        {
          "kind": "event",
          "eventIdentifier": "platform:worker_task_enqueued",
          "dataTemplate": {
            "innerTaskId": "{{event.data.innerTaskId}}",
            "appIdentifier": "{{event.data.appIdentifier}}",
            "workerIdentifier": "{{event.data.workerIdentifier}}"
          }
        }
      ],
      "handler": {
        "type": "external"
      }
    }
  ]
}
