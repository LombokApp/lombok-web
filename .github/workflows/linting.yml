name: Linting

on:
  push:
    branches:
      - '**' # matches every branch
      - '!main' # excludes master
  workflow_dispatch:

jobs:
  check-ui:
    name: Check @stellariscloud/ui package
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest
      - run: bun install
      - run: bun --cwd packages/ui prettier:check
      - run: bun --cwd packages/ui lint:check
      - run: bun --cwd packages/ui tsc:check

  check-api:
    name: Check @stellariscloud/api package
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest
      - run: bun install
      - run: bun --cwd packages/api prettier:check
      - run: bun --cwd packages/api lint:check
      - run: bun --cwd packages/api tsc:check

  check-core-worker:
    name: Check @stellariscloud/core-worker package
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest
      - run: bun install
      - run: bun --cwd packages/core-worker prettier:check
      - run: bun --cwd packages/core-worker lint:check
      - run: bun --cwd packages/core-worker tsc:check

  check-app-browser-sdk:
    name: Check @stellariscloud/app-browser-sdk package
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest
      - run: bun install
      - run: bun --cwd packages/app-browser-sdk prettier:check
      - run: bun --cwd packages/app-browser-sdk lint:check
      - run: bun --cwd packages/app-browser-sdk tsc:check

  check-app-worker-sdk:
    name: Check @stellariscloud/app-worker-sdk package
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest
      - run: bun install
      - run: bun --cwd packages/app-worker-sdk prettier:check
      - run: bun --cwd packages/app-worker-sdk lint:check
      - run: bun --cwd packages/app-worker-sdk tsc:check

  check-app-dev-demo:
    name: Check @stellariscloud/app-dev-demo package
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest
      - run: bun install
      - run: bun --cwd packages/app-dev-demo prettier:check
      - run: bun --cwd packages/app-dev-demo lint:check
      - run: bun --cwd packages/app-dev-demo tsc:check

  check-sdk:
    name: Check @stellariscloud/sdk package
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest
      - run: bun install
      - run: bun --cwd packages/sdk prettier:check
      - run: bun --cwd packages/sdk lint:check
      - run: bun --cwd packages/sdk tsc:check

  check-auth-utils:
    name: Check @stellariscloud/auth-utils package
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest
      - run: bun install
      - run: bun --cwd packages/auth-utils prettier:check
      - run: bun --cwd packages/auth-utils lint:check
      - run: bun --cwd packages/auth-utils tsc:check

  check-stellaris-utils:
    name: Check @stellariscloud/utils package
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest
      - run: bun install
      - run: bun --cwd packages/stellaris-utils prettier:check
      - run: bun --cwd packages/stellaris-utils lint:check
      - run: bun --cwd packages/stellaris-utils tsc:check

  check-stellaris-types:
    name: Check @stellariscloud/types package
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest
      - run: bun install
      - run: bun --cwd packages/stellaris-types prettier:check
      - run: bun --cwd packages/stellaris-types lint:check
      - run: bun --cwd packages/stellaris-types tsc:check

  check-ui-toolkit:
    name: Check @stellariscloud/ui-toolkit package
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest
      - run: bun install
      - run: bun --cwd packages/ui-toolkit prettier:check
      - run: bun --cwd packages/ui-toolkit lint:check
      - run: bun --cwd packages/ui-toolkit tsc:check
