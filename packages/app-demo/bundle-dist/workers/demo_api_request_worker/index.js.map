{
  "version": 3,
  "sources": ["../../app-demo-workers/src/workers/demo_api_request_worker/index.ts"],
  "sourcesContent": [
    "import type { RequestHandler } from '@lombokapp/app-worker-sdk'\n\nexport const handleRequest: RequestHandler = async function handleRequest(\n  request,\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  { serverClient, dbClient, actor },\n) {\n  console.log(\n    'DEMO API REQUEST WORKER REQUEST HANDLER:',\n    new URL(request.url).pathname,\n  )\n\n  if (actor?.actorType === 'system') {\n    console.log('System request')\n  } else if (actor?.actorType === 'user') {\n    console.log('User request:', actor.userId)\n  } else {\n    console.log('Unauthenticated request')\n  }\n\n  // Log detailed request information\n  const headersObj: Record<string, string> = {}\n  request.headers.forEach((value, key) => {\n    headersObj[key] = value\n  })\n\n  console.log('Request details:', {\n    method: request.method,\n    url: request.url,\n    headers: headersObj,\n    hasBody: request.body !== null,\n  })\n\n  // Log body content if present (for debugging purposes)\n  if (request.body) {\n    try {\n      const contentType = request.headers.get('Content-Type') || ''\n      if (contentType.includes('application/json')) {\n        const bodyData = (await request.json()) as unknown\n        console.log('Request JSON body:', bodyData)\n      } else if (contentType.includes('text/')) {\n        const bodyText = await request.text()\n        console.log('Request text body:', bodyText)\n      } else {\n        console.log('Request has body with content-type:', contentType)\n      }\n    } catch (error) {\n      console.log('Could not parse request body:', error)\n    }\n  }\n\n  // Test database connection with a simple query\n  try {\n    console.log('Testing database connection...')\n    const result = await dbClient.query(\n      'SELECT NOW() as current_time, current_database() as database_name',\n    )\n    console.log('Database query result:', result)\n\n    // Try to query the demo tables if they exist\n    try {\n      const demoEntitiesResult = await dbClient.query(\n        'SELECT COUNT(*) as demo_entity_count FROM demo_entities',\n      )\n      console.log('Demo entities table query result:', demoEntitiesResult)\n    } catch (error) {\n      console.log('Demo entities table not found or not accessible:', error)\n    }\n  } catch (error) {\n    console.log('Database query failed:', error)\n  }\n\n  return new Response(\n    JSON.stringify({\n      message: 'Hello, world (from demo API request worker)!',\n      timestamp: new Date().toISOString(),\n      databaseTest: 'Database client is available and working',\n    }),\n    {\n      status: 200,\n    },\n  )\n}\n"
  ],
  "mappings": ";AAEO,IAAM,EAAgC,cAA4B,CACvE,GAEE,eAAc,WAAU,SAC1B,CAMA,GALA,QAAQ,IACN,2CACA,IAAI,IAAI,EAAQ,GAAG,EAAE,QACvB,EAEI,GAAO,YAAc,SACvB,QAAQ,IAAI,gBAAgB,EACvB,QAAI,GAAO,YAAc,OAC9B,QAAQ,IAAI,gBAAiB,EAAM,MAAM,EAEzC,aAAQ,IAAI,yBAAyB,EAIvC,IAAM,EAAqC,CAAC,EAa5C,GAZA,EAAQ,QAAQ,QAAQ,CAAC,EAAO,IAAQ,CACtC,EAAW,GAAO,EACnB,EAED,QAAQ,IAAI,mBAAoB,CAC9B,OAAQ,EAAQ,OAChB,IAAK,EAAQ,IACb,QAAS,EACT,QAAS,EAAQ,OAAS,IAC5B,CAAC,EAGG,EAAQ,KACV,GAAI,CACF,IAAM,EAAc,EAAQ,QAAQ,IAAI,cAAc,GAAK,GAC3D,GAAI,EAAY,SAAS,kBAAkB,EAAG,CAC5C,IAAM,EAAY,MAAM,EAAQ,KAAK,EACrC,QAAQ,IAAI,qBAAsB,CAAQ,EACrC,QAAI,EAAY,SAAS,OAAO,EAAG,CACxC,IAAM,EAAW,MAAM,EAAQ,KAAK,EACpC,QAAQ,IAAI,qBAAsB,CAAQ,EAE1C,aAAQ,IAAI,sCAAuC,CAAW,EAEhE,MAAO,EAAO,CACd,QAAQ,IAAI,gCAAiC,CAAK,EAKtD,GAAI,CACF,QAAQ,IAAI,gCAAgC,EAC5C,IAAM,EAAS,MAAM,EAAS,MAC5B,mEACF,EACA,QAAQ,IAAI,yBAA0B,CAAM,EAG5C,GAAI,CACF,IAAM,EAAqB,MAAM,EAAS,MACxC,yDACF,EACA,QAAQ,IAAI,oCAAqC,CAAkB,EACnE,MAAO,EAAO,CACd,QAAQ,IAAI,mDAAoD,CAAK,GAEvE,MAAO,EAAO,CACd,QAAQ,IAAI,yBAA0B,CAAK,EAG7C,OAAO,IAAI,SACT,KAAK,UAAU,CACb,QAAS,+CACT,UAAW,IAAI,KAAK,EAAE,YAAY,EAClC,aAAc,0CAChB,CAAC,EACD,CACE,OAAQ,GACV,CACF",
  "debugId": "2D77AE09ACC53FD264756E2164756E21",
  "names": []
}